<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fat-Loss Tracker</title>
<link rel="manifest" href="manifest.webmanifest?v=3.8">
<link rel="apple-touch-icon" href="icons/icon-192.svg?v=3.8">
<meta name="theme-color" content="#0b5fff">
<style>
  :root{--bg:#f6f7f9;--fg:#111;--muted:#666;--card:#fff;--accent:#0b5fff;--ok:#0a7b34;--ring:#3b82f6;}
  body{margin:0;background:var(--bg);color:var(--fg);font:14px system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  .wrap{max-width:820px;margin:0 auto;padding:12px}
  h1{font-size:20px;margin:10px 0 6px 0}
  .sub{color:var(--muted);font-size:12px;margin-bottom:8px}
  .tabs{display:flex;gap:8px;overflow:auto;padding-bottom:8px}
  .tab{border:1px solid #ccc;border-radius:999px;padding:6px 10px;background:#fff;white-space:nowrap;cursor:pointer}
  .tab.active{background:#000;color:#fff;border-color:#000}
  .row{background:var(--card);border:1px solid #e5e7eb;border-radius:14px;padding:10px;margin:8px 0}
  .row.today{outline:2px solid var(--ring)}
  .datewrap{display:flex;align-items:center;gap:6px}
  .badge{font-size:10px;background:#3b82f6;color:#fff;border-radius:999px;padding:2px 6px}
  .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-top:6px}
  .pill{background:#f3f4f6;border-radius:10px;padding:6px;text-align:center}
  .pill .t{font-weight:600;font-size:12px}
  .pill .v{font-size:12px}
  .grid2{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;margin-top:6px}
  input, select{width:100%;padding:8px;border:1px solid #ccc;border-radius:8px}
  .btn{font-size:12px;border:1px solid #ddd;border-radius:8px;padding:6px 10px;background:#f3f4f6;cursor:pointer}
  .btn.danger{background:#fee2e2;color:#b91c1c;border-color:#fecaca}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:10px;margin-top:10px}
  .grid3{display:grid;grid-template-columns:1fr 90px 140px;gap:8px}
  canvas{max-width:100%}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Fat-Loss Tracker</h1>
    <div class="sub">v3.8 ‚Ä¢ Today highlight + sets√óreps fixed</div>
  </header>
  <nav class="tabs">
    <button class="tab active" id="tab-tracker">Tracker</button>
    <button class="tab" id="tab-train">Training Log</button>
    <button class="tab" id="tab-bw">Body Weight</button>
    <button class="tab" id="tab-trends">Lift Trends</button>
    <button class="tab" id="tab-proj">Weight Projection</button>
  </nav>
  <main>
    <section id="page-tracker"></section>
  </main>
</div>
<script>
function isoLocal(d){const dt=new Date(d);return dt.getFullYear()+"-"+String(dt.getMonth()+1).padStart(2,"0")+"-"+String(dt.getDate()).padStart(2,"0");}
function sameDay(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate();}
const START=new Date('2025-10-12T00:00:00'),END=new Date('2025-12-01T00:00:00');
const GOAL=[75.8,74.6,73.2,71.8,70.3,68.8,67.0];
const PH=[{w:[1,2],cal:1950,p:175,c:160,f:60,b:{strength:375,cardio:300,hiit:250,rest:150}},
          {w:[3,4,5],cal:1800,p:175,c:130,f:55,b:{strength:425,cardio:350,hiit:300,rest:150}},
          {w:[6,7],cal:1950,p:175,c:150,f:60,b:{strength:325,cardio:275,hiit:250,rest:150}}];
function phase(w){return PH.find(x=>x.w.includes(w))||PH[PH.length-1];}
function addDays(d,n){const x=new Date(d);x.setDate(x.getDate()+n);return x;}
function dn(d){return d.toLocaleDateString('en-US',{weekday:'short'});}
function lab(d){return d.toLocaleDateString('en-US',{month:'short',day:'2-digit'});}
function isCheat(d){const k=Math.floor((d-START)/86400000);return k>=0&&k%10===6;}
const T_FROM=new Date('2025-10-16T00:00:00'),T_TO=new Date('2025-10-20T23:59:59');
function isTravel(d){return d>=T_FROM&&d<=T_TO;}
function wo(week,jsDay,d){
 if(isTravel(d)){if(jsDay===0)return"Travel ‚Äî Active Recovery: Walk 30‚Äì40 min + mobility 10 min";
  return"Travel ‚Äî Skipping 10√ó(30s/15s); Push-Ups 3√ó15‚Äì20; Bodyweight Squats 3√ó20; Plank 3√ó60s; (Opt) Burpees 2√ó10";}
 const b=week<=2?1:(week<=4?2:3);
 if(jsDay===1){if(b===1)return"Push: Bench Press 4√ó8; Incline DB Press 3√ó10; Overhead Press 3√ó8; Cable Fly 3√ó15; Triceps Pushdown 3√ó12";
  if(b===2)return"Push: DB Bench Press 4√ó8; Arnold Press 3√ó10; Pec Deck 3√ó15; Lateral Raise 3√ó15; Overhead Rope Extension 3√ó12";
  return"Push: Close-Grip Bench 4√ó8; Seated DB Shoulder Press 3√ó10; Machine Fly 3√ó15; Lateral Raise 3√ó15; Skull Crushers 3√ó12";}
 if(jsDay===2){if(b===1)return"Pull: Deadlift 4√ó6; Lat Pulldown 3√ó10; Seated Row 3√ó10; Face Pull 3√ó15; DB Curl 3√ó10";
  if(b===2)return"Pull: Rack Pull 4√ó6; Chin-Up 4√óAMRAP; T-Bar Row 3√ó10; Rear Delt Fly 3√ó15; Hammer Curl 3√ó10";
  return"Pull: Deadlift 4√ó6; DB Pullover 3√ó12; One-Arm Row 3√ó10; Face Pull 3√ó15; Cable Curl 3√ó12";}
 if(jsDay===3){if(b===1)return"Legs: Back Squat 4√ó8; Romanian Deadlift 3√ó10; Leg Press 3√ó12; Walking Lunge 3√ó12; Calf Raise 4√ó15";
  if(b===2)return"Legs: Front Squat 4√ó6‚Äì8; Hip Thrust 3√ó10; Hack Squat 3√ó10; Step-Up 3√ó12; Calf Raise 4√ó15";
  return"Legs: Bulgarian Split Squat 3√ó10/leg; Stiff-Leg Deadlift 3√ó10; Leg Extension 3√ó12; Leg Curl 3√ó12; Calf Raise 4√ó15";}
 if(jsDay===4)return"Cardio: Zone 2 30‚Äì40 min + Mobility 10 min";
 if(jsDay===5){if(b===1)return"Upper Power: Bench 5√ó5; Barbell Row 5√ó5; Pull-Ups AMRAP; Dips 3√ó10; Hanging Leg Raise 3√ó15";
  if(b===2)return"Upper Power: Incline Bench 5√ó5; Weighted Chin-Up 5√ó5; DB Row 3√ó10; Close-Grip Push-Up 3√ó15; Cable Crunch 3√ó15";
  return"Upper Power: Flat DB Press 5√ó5; Pendlay Row 5√ó5; Pull-Up AMRAP; Dips 3√ó12; Ab Wheel Rollout 3√ó10";}
 if(jsDay===6)return"Cardio: Zone 2 30‚Äì40 min (or Skipping Intervals)";
 return"Rest / Active Recovery (Walk + Stretch)";
}
function buildPlan(){
 const out=[];let d=new Date(START),w=1;
 while(d<=END){if(d.getDay()===1&&out.length)w++;const ph=phase(w);const desc=wo(w,d.getDay(),d);
 let type=desc.startsWith("Cardio")?"cardio":(desc.startsWith("Upper Power")||desc.startsWith("Push")||desc.startsWith("Pull")||desc.startsWith("Legs")?"strength":(desc.startsWith("Travel")?(desc.includes("Skipping")?"hiit":"rest"):"rest"));
 let cal=ph.cal,p=ph.p,c=ph.c,f=ph.f;if(isCheat(d)){cal=3000;type='rest';}const burn=ph.b[type]||ph.b.rest;
 out.push({date:new Date(d),week:w,dayName:dn(d),label:lab(d),desc,type,cal,p,c,f,burn,goal:GOAL[Math.min(w-1,GOAL.length-1)]});
 d=addDays(d,1);}return out;}
function dn(d){return d.toLocaleDateString('en-US',{weekday:'short'});}function lab(d){return d.toLocaleDateString('en-US',{month:'short',day:'2-digit'});}
const planDays=buildPlan();

function el(tag,props={},...kids){const e=document.createElement(tag);Object.entries(props).forEach(([k,v])=>{if(k==='class')e.className=v;else if(k==='html')e.innerHTML=v;else e.setAttribute(k,v);});kids.flat().forEach(k=>{if(typeof k==='string')e.appendChild(document.createTextNode(k));else if(k)e.appendChild(k);});return e;}
function clear(n){while(n.firstChild)n.removeChild(n.firstChild);}

function renderTracker(){
 const root=document.getElementById('page-tracker');clear(root);
 const today=new Date();
 const m=new Map();planDays.forEach(d=>{if(!m.has(d.week))m.set(d.week,[]);m.get(d.week).push(d);});
 const weeks=[...m.entries()].map(([w,items])=>({week:w,items}));
 let activeWeek=weeks.find(w=>w.items.some(x=>sameDay(x.date,today)))?.week||weeks[0].week;
 const tabs=el('div',{class:'tabs'});
 weeks.forEach(w=>{const b=el('button',{class:'tab'+(w.week===activeWeek?' active':'' )},`Week ${w.week}`);b.onclick=()=>{activeWeek=w.week;draw();};tabs.appendChild(b);});
 root.appendChild(tabs);
 const container=el('div');root.appendChild(container);
 function draw(){clear(container);const w=weeks.find(x=>x.week===activeWeek);
   const title=el('div',{class:'sub'},`Week ${w.week} ‚Ä¢ Goal ${w.items[0].goal.toFixed(1)} kg`);container.appendChild(title);
   w.items.forEach(d=>{const isToday=sameDay(d.date,today);const li=el('div',{class:'row'+(isToday?' today':'')});
     const head=el('div',{class:'datewrap'});head.append(el('div',{},d.dayName+' '+d.label));if(isToday)head.append(el('span',{class:'badge'},'TODAY'));li.append(head);
     li.append(el('div',{},'üèãÔ∏è ',d.desc));
     const grid=el('div',{class:'grid'});[['Burn',d.burn+' kcal'],['Food',d.cal+' kcal'],['Carbs',d.c+' g'],['Fat',d.f+' g']].forEach(([t,v])=>{grid.append(el('div',{class:'pill'},el('div',{class:'t'},t),el('div',{class:'v'},v)));});li.append(grid);
     const grid2=el('div',{class:'grid2'});[['Protein',d.p+' g'],['Goal',w.items[0].goal.toFixed(1)+' kg']].forEach(([t,v])=>{grid2.append(el('div',{class:'pill'},el('div',{class:'t'},t),el('div',{class:'v'},v)));});li.append(grid2);
     container.appendChild(li);});}
 draw();
}
renderTracker();
</script>
</body>
</html>
